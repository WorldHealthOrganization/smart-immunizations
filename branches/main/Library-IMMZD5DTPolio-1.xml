<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1" xmlns:t="urn:hl7-org:elm-types:r1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:fhir="http://hl7.org/fhir" xmlns:qdm43="urn:healthit-gov:qdm:v4_3" xmlns:qdm53="urn:healthit-gov:qdm:v5_3" xmlns:a="urn:hl7-org:cql-annotations:r1">
   <annotation translatorVersion="2.7.0" translatorOptions="EnableAnnotations,EnableLocators,DisableListDemotion,DisableListPromotion" xsi:type="a:CqlToElmInfo"/>
   <annotation xsi:type="a:Annotation">
      <a:s r="41">
         <a:s>/*
 * Library: IMMZD5DTPolio (IMMZ.D5.DT.Polio contraindications)
 * Rule: &quot;Check for contraindications before administering the vaccine(s) due	&quot;
 * Decision Table: Potential contraindications				
 * Trigger: IMMZ.D5 Determine vaccine(s) to be administered based on contraindications
 */
library IMMZD5DTPolio</a:s>
      </a:s>
   </annotation>
   <identifier id="IMMZD5DTPolio" system="http://smart.who.int/ig/smart-immunizations"/>
   <schemaIdentifier id="urn:hl7-org:elm" version="r1"/>
   <usings>
      <def localIdentifier="System" uri="urn:hl7-org:elm-types:r1"/>
      <def localId="1" locator="10:1-10:26" localIdentifier="FHIR" uri="http://hl7.org/fhir" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="1">
               <a:s>// Start Skeleton CQL
using </a:s>
               <a:s>
                  <a:s>FHIR</a:s>
               </a:s>
               <a:s> version '4.0.1'</a:s>
            </a:s>
         </annotation>
      </def>
   </usings>
   <includes>
      <def localId="2" locator="11:1-11:35" localIdentifier="FHIRHelpers" path="http://smart.who.int/ig/smart-immunizations/FHIRHelpers" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="2">
               <a:s>include </a:s>
               <a:s>
                  <a:s>FHIRHelpers</a:s>
               </a:s>
               <a:s> version '4.0.1'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="3" locator="12:1-12:33" localIdentifier="IMMZCom" path="http://smart.who.int/ig/smart-immunizations/IMMZCommon">
         <annotation xsi:type="a:Annotation">
            <a:s r="3">
               <a:s>include </a:s>
               <a:s>
                  <a:s>IMMZCommon</a:s>
               </a:s>
               <a:s> called IMMZCom</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="4" locator="13:1-13:33" localIdentifier="IMMZc" path="http://smart.who.int/ig/smart-immunizations/IMMZConcepts">
         <annotation xsi:type="a:Annotation">
            <a:s r="4">
               <a:s>include </a:s>
               <a:s>
                  <a:s>IMMZConcepts</a:s>
               </a:s>
               <a:s> called IMMZc</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="5" locator="14:1-14:33" localIdentifier="IMMZCon" path="http://smart.who.int/ig/smart-immunizations/IMMZConfig">
         <annotation xsi:type="a:Annotation">
            <a:s r="5">
               <a:s>include </a:s>
               <a:s>
                  <a:s>IMMZConfig</a:s>
               </a:s>
               <a:s> called IMMZCon</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="6" locator="15:1-15:40" localIdentifier="IMMZvl" path="http://smart.who.int/ig/smart-immunizations/IMMZVaccineLibrary">
         <annotation xsi:type="a:Annotation">
            <a:s r="6">
               <a:s>include </a:s>
               <a:s>
                  <a:s>IMMZVaccineLibrary</a:s>
               </a:s>
               <a:s> called IMMZvl</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="7" locator="16:1-16:28" localIdentifier="FC" path="http://smart.who.int/ig/smart-immunizations/FHIRCommon">
         <annotation xsi:type="a:Annotation">
            <a:s r="7">
               <a:s>include </a:s>
               <a:s>
                  <a:s>FHIRCommon</a:s>
               </a:s>
               <a:s> called FC</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="8" locator="17:1-17:39" localIdentifier="input" path="http://smart.who.int/ig/smart-immunizations/IMMZD2DTPolioInput">
         <annotation xsi:type="a:Annotation">
            <a:s r="8">
               <a:s>include </a:s>
               <a:s>
                  <a:s>IMMZD2DTPolioInput</a:s>
               </a:s>
               <a:s> called input</a:s>
            </a:s>
         </annotation>
      </def>
   </includes>
   <statements>
      <def locator="20:1-20:15" name="Patient" context="Patient">
         <expression xsi:type="SingletonFrom">
            <operand locator="20:1-20:15" dataType="fhir:Patient" templateId="http://hl7.org/fhir/StructureDefinition/Patient" xsi:type="Retrieve"/>
         </expression>
      </def>
      <def localId="15" locator="65:1-66:61" name="Polio vaccination could be contraindicated. Clinical judgement required" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="15">
               <a:s>/*
@output: Polio vaccination could be contraindicated. Clinical judgement required
@pseudocode: &quot;Immunization recommendation status&quot; = 'Further evaluation needed'
*/
define &quot;Polio vaccination could be contraindicated. Clinical judgement required&quot;:
  </a:s>
               <a:s r="14">
                  <a:s r="13">
                     <a:s>input</a:s>
                  </a:s>
                  <a:s>.</a:s>
                  <a:s r="14">
                     <a:s>&quot;The client has history of severe allergic reactions&quot;</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="14" locator="66:3-66:61" name="The client has history of severe allergic reactions" libraryName="input" xsi:type="ExpressionRef"/>
      </def>
      <def localId="19" locator="73:1-74:255" name="Polio vaccination could be contraindicated. Clinical judgement required Guidance" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="19">
               <a:s>/*
@output: Polio vaccination could be contraindicated. Clinical judgement required Guidance
@guidance: Do not vaccinate client for IPV if client has had a previous severe reaction or known allergy to streptomycin, neomycin or polymyxin B.
Do not vaccinate client for OPV if client has had a allergic reaction to OPV or to the trace antibiotics contained.
*/
define &quot;Polio vaccination could be contraindicated. Clinical judgement required Guidance&quot;:
  </a:s>
               <a:s r="18">
                  <a:s>'Do not vaccinate client for IPV if client has had a previous severe reaction or known allergy to streptomycin, neomycin or polymyxin B.
Do not vaccinate client for OPV if client has had a allergic reaction to OPV or to the trace antibiotics contained.'</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="18" locator="74:3-74:255" valueType="t:String" value="Do not vaccinate client for IPV if client has had a previous severe reaction or known allergy to streptomycin, neomycin or polymyxin B.&#xa;Do not vaccinate client for OPV if client has had a allergic reaction to OPV or to the trace antibiotics contained." xsi:type="Literal"/>
      </def>
      <def localId="24" locator="81:1-82:50" name="Polio vaccination with bOPV is contraindicated Case 1" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="24">
               <a:s>/*
@output: Polio vaccination with bOPV is contraindicated Case 1
@pseudocode: &quot;Immunization recommendation status&quot; =  'Contraindicated' (where &quot;Type of polio dose&quot; = 'bOPV') AND &quot;Immunization recommendation status&quot; = 'Further evaluation needed' (where &quot;Type of polio dose&quot; = 'IPV')
*/
define &quot;Polio vaccination with bOPV is contraindicated Case 1&quot;:
  </a:s>
               <a:s r="23">
                  <a:s r="22">
                     <a:s>input</a:s>
                  </a:s>
                  <a:s>.</a:s>
                  <a:s r="23">
                     <a:s>&quot;The client is severely immunocompromised&quot;</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="23" locator="82:3-82:50" name="The client is severely immunocompromised" libraryName="input" xsi:type="ExpressionRef"/>
      </def>
      <def localId="28" locator="89:1-90:51" name="Polio vaccination with bOPV is contraindicated Case 2" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="28">
               <a:s>/*
@output: Polio vaccination with bOPV is contraindicated Case 2
@pseudocode: &quot;Immunization recommendation status&quot; =  'Contraindicated' (where &quot;Type of polio dose&quot; = 'bOPV') AND &quot;Immunization recommendation status&quot; = 'Further evaluation needed' (where &quot;Type of polio dose&quot; = 'IPV')

*/
define &quot;Polio vaccination with bOPV is contraindicated Case 2&quot;:
  </a:s>
               <a:s r="27">
                  <a:s r="26">
                     <a:s>input</a:s>
                  </a:s>
                  <a:s>.</a:s>
                  <a:s r="27">
                     <a:s>&quot;The client has immunodeficiency syndromes&quot;</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="27" locator="90:3-90:51" name="The client has immunodeficiency syndromes" libraryName="input" xsi:type="ExpressionRef"/>
      </def>
      <def localId="31" locator="96:1-98:62" name="Polio vaccination with bOPV is contraindicated" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="31">
               <a:s>/*
@output: Polio vaccination with bOPV is contraindicated
@pseudocode: &quot;Immunization recommendation status&quot; =  'Contraindicated' (where &quot;Type of polio dose&quot; = 'bOPV') AND &quot;Immunization recommendation status&quot; = 'Further evaluation needed' (where &quot;Type of polio dose&quot; = 'IPV')
*/
define &quot;Polio vaccination with bOPV is contraindicated&quot;:
  </a:s>
               <a:s r="30">
                  <a:s r="25">
                     <a:s>&quot;Polio vaccination with bOPV is contraindicated Case 1&quot;</a:s>
                  </a:s>
                  <a:s>
    or </a:s>
                  <a:s r="29">
                     <a:s>&quot;Polio vaccination with bOPV is contraindicated Case 2&quot;</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="30" locator="97:3-98:62" xsi:type="Or">
            <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
            <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
            <operand localId="25" locator="97:3-97:57" name="Polio vaccination with bOPV is contraindicated Case 1" xsi:type="ExpressionRef"/>
            <operand localId="29" locator="98:8-98:62" name="Polio vaccination with bOPV is contraindicated Case 2" xsi:type="ExpressionRef"/>
         </expression>
      </def>
      <def localId="41" locator="109:1-118:5" name="Polio vaccination with bOPV is contraindicated Guidance" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="41">
               <a:s>/*
@output: Polio vaccination with bOPV is contraindicated Guidance
@guidance: For bOPV dose, do not vaccinate  client for bOPV dose as bOPV vaccination is contraindicated in severely immunocompromised clients. 

Check if vaccination with IPV is appropriate for the client, consider risks of vaccination and make a clinical judgement.
@guidance: For bOPV dose, do not vaccinate  client for bOPV dose as bOPV vaccination is contraindicated in clients with immunodeficiency disorders.. 

Check if vaccination with IPV is appropriate for the client, consider risks of vaccination and make a clinical judgement.
*/
define &quot;Polio vaccination with bOPV is contraindicated Guidance&quot;:
  </a:s>
               <a:s r="40">
                  <a:s>case
    </a:s>
                  <a:s r="35">
                     <a:s>when </a:s>
                     <a:s r="33">
                        <a:s>&quot;Polio vaccination with bOPV is contraindicated Case 1&quot;</a:s>
                     </a:s>
                     <a:s> then </a:s>
                     <a:s r="34">
                        <a:s>'For bOPV dose, do not vaccinate  client for bOPV dose as bOPV vaccination is contraindicated in severely immunocompromised clients. 

Check if vaccination with IPV is appropriate for the client, consider risks of vaccination and make a clinical judgement.'</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="38">
                     <a:s>when </a:s>
                     <a:s r="36">
                        <a:s>&quot;Polio vaccination with bOPV is contraindicated Case 2&quot;</a:s>
                     </a:s>
                     <a:s> then </a:s>
                     <a:s r="37">
                        <a:s>'For bOPV dose, do not vaccinate  client for bOPV dose as bOPV vaccination is contraindicated in clients with immunodeficiency disorders.. 

Check if vaccination with IPV is appropriate for the client, consider risks of vaccination and make a clinical judgement.'</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    else </a:s>
                  <a:s r="39">
                     <a:s>''</a:s>
                  </a:s>
                  <a:s>
  end</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="40" locator="110:3-118:5" xsi:type="Case">
            <caseItem localId="35" locator="111:5-111:327">
               <when localId="33" locator="111:10-111:64" name="Polio vaccination with bOPV is contraindicated Case 1" xsi:type="ExpressionRef"/>
               <then localId="34" locator="111:71-111:327" valueType="t:String" value="For bOPV dose, do not vaccinate  client for bOPV dose as bOPV vaccination is contraindicated in severely immunocompromised clients. &#xa;&#xa;Check if vaccination with IPV is appropriate for the client, consider risks of vaccination and make a clinical judgement." xsi:type="Literal"/>
            </caseItem>
            <caseItem localId="38" locator="114:5-114:333">
               <when localId="36" locator="114:10-114:64" name="Polio vaccination with bOPV is contraindicated Case 2" xsi:type="ExpressionRef"/>
               <then localId="37" locator="114:71-114:333" valueType="t:String" value="For bOPV dose, do not vaccinate  client for bOPV dose as bOPV vaccination is contraindicated in clients with immunodeficiency disorders.. &#xa;&#xa;Check if vaccination with IPV is appropriate for the client, consider risks of vaccination and make a clinical judgement." xsi:type="Literal"/>
            </caseItem>
            <else localId="39" locator="117:10-117:11" valueType="t:String" value="" xsi:type="Literal"/>
         </expression>
      </def>
      <def localId="46" locator="54:1-59:5" name="Guidance" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="46">
               <a:s>/*
@dynamicValue: Guidance
*/
define &quot;Guidance&quot;:
  </a:s>
               <a:s r="45">
                  <a:s>case
    </a:s>
                  <a:s r="21">
                     <a:s>when </a:s>
                     <a:s r="17">
                        <a:s>&quot;Polio vaccination could be contraindicated. Clinical judgement required&quot;</a:s>
                     </a:s>
                     <a:s> then </a:s>
                     <a:s r="20">
                        <a:s>&quot;Polio vaccination could be contraindicated. Clinical judgement required Guidance&quot;</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="43">
                     <a:s>when </a:s>
                     <a:s r="32">
                        <a:s>&quot;Polio vaccination with bOPV is contraindicated&quot;</a:s>
                     </a:s>
                     <a:s> then </a:s>
                     <a:s r="42">
                        <a:s>&quot;Polio vaccination with bOPV is contraindicated Guidance&quot;</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    else </a:s>
                  <a:s r="44">
                     <a:s>''</a:s>
                  </a:s>
                  <a:s>
  end</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="45" locator="55:3-59:5" xsi:type="Case">
            <caseItem localId="21" locator="56:5-56:170">
               <when localId="17" locator="56:10-56:82" name="Polio vaccination could be contraindicated. Clinical judgement required" xsi:type="ExpressionRef"/>
               <then localId="20" locator="56:89-56:170" name="Polio vaccination could be contraindicated. Clinical judgement required Guidance" xsi:type="ExpressionRef"/>
            </caseItem>
            <caseItem localId="43" locator="57:5-57:120">
               <when localId="32" locator="57:10-57:57" name="Polio vaccination with bOPV is contraindicated" xsi:type="ExpressionRef"/>
               <then localId="42" locator="57:64-57:120" name="Polio vaccination with bOPV is contraindicated Guidance" xsi:type="ExpressionRef"/>
            </caseItem>
            <else localId="44" locator="58:10-58:11" valueType="t:String" value="" xsi:type="Literal"/>
         </expression>
      </def>
      <def localId="74" locator="25:1-36:5" name="Test Validation" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="74">
               <a:s>/*
@test: Test expected results based on example patients
*/
define &quot;Test Validation&quot;:
  </a:s>
               <a:s r="73">
                  <a:s>case 
    </a:s>
                  <a:s r="51">
                     <a:s>when </a:s>
                     <a:s r="12">
                        <a:s r="10">
                           <a:s r="9">
                              <a:s>Patient</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="10">
                              <a:s>id</a:s>
                           </a:s>
                        </a:s>
                        <a:s> = </a:s>
                        <a:s r="11">
                           <a:s>'87.allergic'</a:s>
                        </a:s>
                     </a:s>
                     <a:s> then </a:s>
                     <a:s r="50">
                        <a:s r="16">
                           <a:s>&quot;Polio vaccination could be contraindicated. Clinical judgement required&quot;</a:s>
                        </a:s>
                        <a:s> and </a:s>
                        <a:s r="49">
                           <a:s r="47">
                              <a:s>&quot;Guidance&quot;</a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="48">
                              <a:s>'Do not vaccinate client for IPV if client has had a previous severe reaction or known allergy to streptomycin, neomycin or polymyxin B.
Do not vaccinate client for OPV if client has had a allergic reaction to OPV or to the trace antibiotics contained.'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="61">
                     <a:s>when </a:s>
                     <a:s r="55">
                        <a:s r="53">
                           <a:s r="52">
                              <a:s>Patient</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="53">
                              <a:s>id</a:s>
                           </a:s>
                        </a:s>
                        <a:s> = </a:s>
                        <a:s r="54">
                           <a:s>'88.immunocompromised'</a:s>
                        </a:s>
                     </a:s>
                     <a:s> then </a:s>
                     <a:s r="60">
                        <a:s r="56">
                           <a:s>&quot;Polio vaccination with bOPV is contraindicated Case 1&quot;</a:s>
                        </a:s>
                        <a:s> and </a:s>
                        <a:s r="59">
                           <a:s r="57">
                              <a:s>&quot;Guidance&quot;</a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="58">
                              <a:s>'For bOPV dose, do not vaccinate  client for bOPV dose as bOPV vaccination is contraindicated in severely immunocompromised clients. 

Check if vaccination with IPV is appropriate for the client, consider risks of vaccination and make a clinical judgement.'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="71">
                     <a:s>when </a:s>
                     <a:s r="65">
                        <a:s r="63">
                           <a:s r="62">
                              <a:s>Patient</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="63">
                              <a:s>id</a:s>
                           </a:s>
                        </a:s>
                        <a:s> = </a:s>
                        <a:s r="64">
                           <a:s>'89.immunodeficiency'</a:s>
                        </a:s>
                     </a:s>
                     <a:s> then </a:s>
                     <a:s r="70">
                        <a:s r="66">
                           <a:s>&quot;Polio vaccination with bOPV is contraindicated Case 2&quot;</a:s>
                        </a:s>
                        <a:s> and </a:s>
                        <a:s r="69">
                           <a:s r="67">
                              <a:s>&quot;Guidance&quot;</a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="68">
                              <a:s>'For bOPV dose, do not vaccinate  client for bOPV dose as bOPV vaccination is contraindicated in clients with immunodeficiency disorders.. 

Check if vaccination with IPV is appropriate for the client, consider risks of vaccination and make a clinical judgement.'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    else </a:s>
                  <a:s r="72">
                     <a:s>'No test case set'</a:s>
                  </a:s>
                  <a:s>
  end</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="73" locator="26:3-36:5" xsi:type="Case">
            <caseItem localId="51" locator="27:5-27:385">
               <when localId="12" locator="27:10-27:35" xsi:type="Equal">
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="10" locator="27:10-27:19" path="id" xsi:type="Property">
                        <source localId="9" locator="27:10-27:16" name="Patient" xsi:type="ExpressionRef"/>
                     </operand>
                  </operand>
                  <operand localId="11" locator="27:23-27:35" valueType="t:String" value="87.allergic" xsi:type="Literal"/>
               </when>
               <then xsi:type="As">
                  <operand localId="50" locator="27:42-27:385" xsi:type="And">
                     <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                     <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="16" locator="27:42-27:114" name="Polio vaccination could be contraindicated. Clinical judgement required" xsi:type="ExpressionRef"/>
                     <operand localId="49" locator="27:120-27:385" xsi:type="Equal">
                        <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="47" locator="27:120-27:129" name="Guidance" xsi:type="ExpressionRef"/>
                        <operand localId="48" locator="27:133-27:385" valueType="t:String" value="Do not vaccinate client for IPV if client has had a previous severe reaction or known allergy to streptomycin, neomycin or polymyxin B.&#xa;Do not vaccinate client for OPV if client has had a allergic reaction to OPV or to the trace antibiotics contained." xsi:type="Literal"/>
                     </operand>
                  </operand>
                  <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                     <choice name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                     <choice name="t:String" xsi:type="NamedTypeSpecifier"/>
                  </asTypeSpecifier>
               </then>
            </caseItem>
            <caseItem localId="61" locator="29:5-29:380">
               <when localId="55" locator="29:10-29:44" xsi:type="Equal">
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="53" locator="29:10-29:19" path="id" xsi:type="Property">
                        <source localId="52" locator="29:10-29:16" name="Patient" xsi:type="ExpressionRef"/>
                     </operand>
                  </operand>
                  <operand localId="54" locator="29:23-29:44" valueType="t:String" value="88.immunocompromised" xsi:type="Literal"/>
               </when>
               <then xsi:type="As">
                  <operand localId="60" locator="29:51-29:380" xsi:type="And">
                     <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                     <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="56" locator="29:51-29:105" name="Polio vaccination with bOPV is contraindicated Case 1" xsi:type="ExpressionRef"/>
                     <operand localId="59" locator="29:111-29:380" xsi:type="Equal">
                        <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="57" locator="29:111-29:120" name="Guidance" xsi:type="ExpressionRef"/>
                        <operand localId="58" locator="29:124-29:380" valueType="t:String" value="For bOPV dose, do not vaccinate  client for bOPV dose as bOPV vaccination is contraindicated in severely immunocompromised clients. &#xa;&#xa;Check if vaccination with IPV is appropriate for the client, consider risks of vaccination and make a clinical judgement." xsi:type="Literal"/>
                     </operand>
                  </operand>
                  <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                     <choice name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                     <choice name="t:String" xsi:type="NamedTypeSpecifier"/>
                  </asTypeSpecifier>
               </then>
            </caseItem>
            <caseItem localId="71" locator="32:5-32:385">
               <when localId="65" locator="32:10-32:43" xsi:type="Equal">
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="63" locator="32:10-32:19" path="id" xsi:type="Property">
                        <source localId="62" locator="32:10-32:16" name="Patient" xsi:type="ExpressionRef"/>
                     </operand>
                  </operand>
                  <operand localId="64" locator="32:23-32:43" valueType="t:String" value="89.immunodeficiency" xsi:type="Literal"/>
               </when>
               <then xsi:type="As">
                  <operand localId="70" locator="32:50-32:385" xsi:type="And">
                     <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                     <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="66" locator="32:50-32:104" name="Polio vaccination with bOPV is contraindicated Case 2" xsi:type="ExpressionRef"/>
                     <operand localId="69" locator="32:110-32:385" xsi:type="Equal">
                        <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="67" locator="32:110-32:119" name="Guidance" xsi:type="ExpressionRef"/>
                        <operand localId="68" locator="32:123-32:385" valueType="t:String" value="For bOPV dose, do not vaccinate  client for bOPV dose as bOPV vaccination is contraindicated in clients with immunodeficiency disorders.. &#xa;&#xa;Check if vaccination with IPV is appropriate for the client, consider risks of vaccination and make a clinical judgement." xsi:type="Literal"/>
                     </operand>
                  </operand>
                  <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                     <choice name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                     <choice name="t:String" xsi:type="NamedTypeSpecifier"/>
                  </asTypeSpecifier>
               </then>
            </caseItem>
            <else xsi:type="As">
               <operand localId="72" locator="35:10-35:27" valueType="t:String" value="No test case set" xsi:type="Literal"/>
               <asTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                  <choice name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
                  <choice name="t:String" xsi:type="NamedTypeSpecifier"/>
               </asTypeSpecifier>
            </else>
         </expression>
      </def>
      <def localId="93" locator="41:1-43:53" name="Draft Medication Request for bOPV dose" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="93">
               <a:s>/*
@internal: Draft Medication Request for Polio bOPV dose
*/
define &quot;Draft Medication Request for bOPV dose&quot;:
	</a:s>
               <a:s r="92">
                  <a:s>
                     <a:s r="76">
                        <a:s r="75">
                           <a:s r="75">
                              <a:s>[MedicationRequest: </a:s>
                              <a:s>
                                 <a:s>IMMZc.&quot;Polio Vaccine - bOPV&quot;</a:s>
                              </a:s>
                              <a:s>]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> MR</a:s>
                     </a:s>
                  </a:s>
                  <a:s> </a:s>
                  <a:s r="85">
                     <a:s>where </a:s>
                     <a:s r="85">
                        <a:s r="80">
                           <a:s r="78">
                              <a:s r="77">
                                 <a:s>MR</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="78">
                                 <a:s>status</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="79">
                              <a:s>'draft'</a:s>
                           </a:s>
                        </a:s>
                        <a:s> and </a:s>
                        <a:s r="84">
                           <a:s r="82">
                              <a:s r="81">
                                 <a:s>MR</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="82">
                                 <a:s>intent</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="83">
                              <a:s>'proposal'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
                  <a:s>
	</a:s>
                  <a:s r="91">
                     <a:s>sort by </a:s>
                     <a:s r="90">
                        <a:s r="89">
                           <a:s>date from </a:s>
                           <a:s r="88">
                              <a:s>(</a:s>
                              <a:s r="88">
                                 <a:s r="86">
                                    <a:s>authoredOn</a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="87">
                                    <a:s>FHIR.dateTime</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s> desc</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="92" locator="42:2-43:53" xsi:type="Query">
            <source localId="76" locator="42:2-42:53" alias="MR">
               <expression localId="75" locator="42:2-42:50" xsi:type="Union">
                  <signature xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <signature xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
                  </signature>
                  <operand dataType="fhir:MedicationRequest" templateId="http://hl7.org/fhir/StructureDefinition/MedicationRequest" codeProperty="medication" codeComparator="in" xsi:type="Retrieve">
                     <codes locator="42:22-42:49" name="Polio Vaccine - bOPV" libraryName="IMMZc" xsi:type="ValueSetRef"/>
                  </operand>
                  <operand locator="42:2-42:50" dataType="fhir:MedicationRequest" templateId="http://hl7.org/fhir/StructureDefinition/MedicationRequest" codeProperty="medication" codeComparator="in" xsi:type="Retrieve">
                     <codes locator="42:22-42:49" name="Polio Vaccine - bOPV" libraryName="IMMZc" xsi:type="ValueSetRef"/>
                  </operand>
               </expression>
            </source>
            <where localId="85" locator="42:55-42:106" xsi:type="And">
               <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
               <signature name="t:Boolean" xsi:type="NamedTypeSpecifier"/>
               <operand localId="80" locator="42:61-42:79" xsi:type="Equal">
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature name="fhir:MedicationRequestStatus" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="78" locator="42:61-42:69" path="status" scope="MR" xsi:type="Property"/>
                  </operand>
                  <operand localId="79" locator="42:73-42:79" valueType="t:String" value="draft" xsi:type="Literal"/>
               </operand>
               <operand localId="84" locator="42:85-42:106" xsi:type="Equal">
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <signature name="t:String" xsi:type="NamedTypeSpecifier"/>
                  <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <signature name="fhir:MedicationRequestIntent" xsi:type="NamedTypeSpecifier"/>
                     <operand localId="82" locator="42:85-42:93" path="intent" scope="MR" xsi:type="Property"/>
                  </operand>
                  <operand localId="83" locator="42:97-42:106" valueType="t:String" value="proposal" xsi:type="Literal"/>
               </operand>
            </where>
            <sort localId="91" locator="43:2-43:53">
               <by localId="90" locator="43:10-43:53" direction="desc" xsi:type="ByExpression">
                  <expression localId="89" locator="43:10-43:48" xsi:type="DateFrom">
                     <signature name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     <operand name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <signature name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        <operand localId="88" locator="43:20-43:48" strict="false" xsi:type="As">
                           <operand localId="86" locator="43:21-43:30" name="authoredOn" xsi:type="IdentifierRef"/>
                           <asTypeSpecifier localId="87" locator="43:35-43:47" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </operand>
                     </operand>
                  </expression>
               </by>
            </sort>
         </expression>
      </def>
      <def localId="97" locator="48:1-49:51" name="Draft Medication Request ID for bOPV dose" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="97">
               <a:s>/*
@dynamicValue: Draft Medication Request ID for Polio bOPV dose
*/
define &quot;Draft Medication Request ID for bOPV dose&quot;:
	</a:s>
               <a:s r="96">
                  <a:s r="95">
                     <a:s>First(</a:s>
                     <a:s r="94">
                        <a:s>&quot;Draft Medication Request for bOPV dose&quot;</a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
                  <a:s>.</a:s>
                  <a:s r="96">
                     <a:s>id</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="96" locator="49:2-49:51" path="id" xsi:type="Property">
            <source localId="95" locator="49:2-49:48" xsi:type="First">
               <signature xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
               </signature>
               <source localId="94" locator="49:8-49:47" name="Draft Medication Request for bOPV dose" xsi:type="ExpressionRef"/>
            </source>
         </expression>
      </def>
   </statements>
</library>
